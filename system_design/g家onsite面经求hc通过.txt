发信人: refurbish (refurbish), 信区: JobHunting
标  题: g家onsite面经求hc通过
发信站: BBS 未名空间站 (Sat Apr 18 14:47:09 2015, 美东)


已经提交hc，但是属于borderline的case，分享面经求通过（之前1m3cd发过简单版）
，相关behavior问题都省略了。

一共五轮，午饭前三轮，午饭后两轮，其中两轮系统设计。因为从国内过来，
recruiter（印度女）特别跟第一个面试官讲我的时差反应，还请他向后面的面试官讲。

1.系统设计，面试官应该是摩洛哥人
给一个url和一个给定的方法genNextUrls可以返回所有从这个url可以直接链接到的url
。要求统计所有能访问到url数。
结果先让我coding，我以为搞错了，问要不要考虑一台机器处理不了的情况，面试官笑
了，说那是followup问题。
就用一个queue和一个hashset走bfs解决之（这里可以反衬我后面一个错误）。面试官
问如果要求判断一个url无效怎么办，我提到了exception处理两种思路，以及
genNextUrls可以怎么处理，面试官说可以，但是如果要求我的方法不能throw
exception出来，怎么让caller知道一开始的url给错了，我blabla。
面试官说现在回到你提到的scalable的问题，你的代码中有哪些地方是bottleneck？我
说genNextUrls和那个hashset，包括为什么blabla。面试官说假定genNextUrls是直接
下载一个url的页面并分析内部url，问我怎么设计这样的系统？然后他又笑笑说，也就
是怎么实现一个web crawler。我就提到几个partition的方案，然后提到google这种规
模的公司必然global很多dc，每个dc根据对应的域名来抓网页，然后问能从这里展开吗
？他点头。我就blabla说这样parse怎么方便合理，最后再加上replication，每个dc应
该拥有所有的信息。然后提到hashset的问题，就是得上DHT了，解释了一下相关思路和
算法，比如consistent hashing是怎么保证添加删除nodes不需要remap所有key等等。
面试官表示满意，很客气的把我交接给第二轮。

2. coding，面试官白人
第一题local minimum，只记得要用binary tree，但是忘了具体怎么做了。于是先说有
brute force 的O(n)，但是显然面试官不要听这个，只好说比O(n)好，就得O(lgn)，要
想O(lgn)就得binary search，然后搞了个简单例子帮助自己想想到底是怎么做的，给
出了code，没想到面试官看破我一知半解的状态，说为什么这样是对的。我回到之前的
例子，解释之，随手给了另外几个例子，结果面试官可能觉得code有问题，亲自上阵设
计了一个复杂例子，结果一跑还是对的，总算放了我一马。第一题大概10分钟搞定，第
二题在数组中检查x距离内是否有重复，在这里跟面试官卯上了。我先给了O(nlgn)的方
案，面试官说不够好，我说那就是O(n)了，我给了个用k大小linkedhashmap的方案，跟
他讨论一番后，他说可以但又说还可以优化一点点。我想想用linkedhashset就可以了
，他说还能优化，我就糊涂了。我想了一会，他提示说回到hashmap的方案，size k可
以被去掉。我想难道只要常数大小？想了半天也没想出来，面试官反复循循善诱，后来
忍不住了，说可以用值做key，value是位置。我说这个空间是O(n)啊，之前就想到了，
但是比O(k)差呀。面试官笑道no，no，比你的方案还是快点。我了个去。(后来午饭的
时候跟陪吃说了这个事)

3.系统设计，面试官是印度人
1000个文件每个有1TB的大小，服务器每台100GB内存，1TB硬盘。文件基本上一次写入
就不会变化了，读的次数比较多。问怎么设计这样的系统。我说硬盘在这里明显是瓶颈
，1个文件起码1台服务器，架构上把读写分为两个services。面试官说不要考虑
service，就从linux底层的角度来考虑，我内心一慌，这个我不懂啊。我硬着头皮说，
那就是两个函数read和write，底层1000台服务器，文件map到服务器的信息可以储存在
每个服务器上也可以由一个central服务器来管理，然后分析利弊。面试官表示满意（
竟然混过），继续问服务器出错了怎么办，我说那就每个文件多加个备份服务器，
active-standby模式，blabla。又问如果需要提高读性能怎么办，答曰active-active
模式应对。再增加1000个这样文件，怎么办，我说那就再增加2000台服务器，central
服务器可以如此这般处理。面试官表示满意，然后问了个小
coding题目，找二叉树中序的第k个数，秒答。结果还剩10多分钟，面试官说他的问题
都问完了，然后就跟我讨论了半天我的phd research。

** 午饭
白人陪吃，他就问我面的如何，我说感觉都可以，就是第二轮没有给出最优。他问啥情
况，我说了一下。然后中间吃饭不提，吃完饭他突然对我说你是对的。我说面试官说我
的方法没他的快，他说bullshit。我心情大爽，但也知道无法改变结果。因为从国内过
来我知道下午1点后就会有强烈的时差反应，我又不能喝咖啡，只好要求午睡一会，陪
吃很nice就抱着笔记本在旁边处理自己的事情。

4. coding，面试官老华裔，还有个shadow老白。
tic-tac-toe，给定场景是人机大战，人永远先开始下，AI有几个下的条件，比如中间
没占，就占中间等等。要求把所有的棋盘布局组合都输出（人机各走一步算一个新的棋
盘布局）。其实原题还要复杂一点，光讲就花了5分钟，后来想想真的是不利因素。一
开始我的思路是走dfs，后来一想不对又想走bfs的backtracking，后来一想还是不对，
直接bfs就可以了。就在这个过程中，出现了问题。因为我觉得我在正常的思考（其实
就是经常熬夜到后半夜的状态，还在思考，速度已经非常慢了，但是自己感觉不到），
但是发现面试官总是迫不及待的出来给提示，说我随手写的bfs方法名为啥还要index（
难道不知道用queue吗，我晕，我这里只是在思考，而且用的是cc150的那种思路，如果
面试官这里说我不懂bfs要用queue，那就跟第一轮的结果成有趣的对照了），还
提示我可以画成一个tree如何如何，我
心想为啥这么着急呢。于是就写了主方法（占30%），结果突然面试官说时间还剩下两
分钟了，不如就到这里吧，我一下懵了，面试官说我很理解你的感受，但是只能到这里
了，你有什么问题要问吗？我说没问题要问，希望两分钟能让我继续写code，他笑了，
说你这么坚持，那就好吧。然后我加力全开，最后也差不多写完了90%，中间面试官还
提醒了一两个优化，最后还剩下一点，但是下轮面试官已经到了，面试官说please
stop，还说剩下的都是trivia，没关系了。因为最后爆发了一下，面试官和shadow都有
点兴奋，拿出手机一顿拍照，搞得和明星签名一样（只是看上去像，其实人家只是例行
公事，但是因为下一轮的面试官也挤进来了，会议室人多嘴杂有点热闹，我就夸张的描
写了一下，其实当时的心情是跌入冰窖）。shadow还说你太牛了，这么两分钟
就差不多写完了，我很惊讶你写了这么多。我哭笑不得，内心那个郁闷啊，不过更多的
是没力气了，脑子一片空白。

5. coding，面试官白人
保龄球计分，给一组分数，输出实际每轮投完后的累计得分。因为脑子完全不转，面试
官讲了两遍我才回过神来，这个也是浪费了时间。后来沟通了一下，写的时候我都不记
得有没有跟面试官讨论各种解决方案，反正一路强写下来，中间需要循环的时候，我犹
豫了一下用while还是for，因为不是每次只+1，但是我想还是用for吧，反正不要最后
的++部分即可（埋下一个祸根）。然后问面试官能不能测几个例子看看对不对，面试官
说可以。结果跑一个例子错一个地方，到最后，面试官还说有个问题不知道你看出来没
有，我脑子一片空白，看了半天没找出来。面试官说for循环我一看，靠，赫然一个i++
。只好把之前纠结讲了一下，面试官说这种地方就应该用while，我说对对，就是觉得
while还要在外面声明一个变量，觉得不漂亮，面试官想想说也对。其实我的方案也就
是每次检查一轮的得分，然后考虑之前的加分放入结果和标志后面两次得分是否应被考
虑为加分，但是写了一堆if else，面试官说这是他见过的最复杂的又work的解决方案
。然后又让我写个junit test，但是我已经有段时间不写production的java code了，
所以一些具体语法都记不住了，就是函数名写对了，逻辑也没错，就是assertEqual啥
的统统忘掉了，都写成了assert，然后给面试官说可以有加条件的assert，面试官说对
的，assertEqual。


面试完了，感觉非常非常沮丧，因为下午两轮其实都是很正常的题目，本来应该一锤定
音的，而且也做了准备，但是还是非常受时差反应的影响，早知道就提前一个星期过来
了。当天就给recruiter发了邮件，把情况解释了一下，希望如果必要的话能再给机会
面一下。结果这个recruiter后来专门打电话过来安慰我，说前三轮的feedback已经收
到了，都是positvie建议move ahead。要我不要过于伤心，说会每天都跟我update的。
我非常吃惊，因为没见过这么nice的recruiter，而且之前她一直给我的印象就是非常
有效率，电面也是当天就给我结果，于是我就夸她真的专业，是我见过的最好的
recruiter，结果她笑了，得意的说今天刚收到部门最佳recuirter的荣誉。她果然keep
promise，一直跟我更新，直到前天说收集了所有feedback送到了hc，我的结果属于
borderline，她也比较郁闷，说下周一跟我电话联系看结果如何。

攒人品，求HC通过啊！！！！
